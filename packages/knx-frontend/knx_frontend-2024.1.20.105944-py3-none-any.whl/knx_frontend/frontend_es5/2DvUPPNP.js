"use strict";(self.webpackChunkknx_frontend=self.webpackChunkknx_frontend||[]).push([[385],{8336:function(e,n,r){var t,a,o,i=r(8962),d=r(3368),s=r(1650),l=r(2390),c=r(9205),u=r(906),p=r(1565),h=(r(7393),r(8144)),g=r(5123);(0,p.Z)([(0,g.Mo)("ha-card")],(function(e,n){var r=function(n){(0,c.Z)(t,n);var r=(0,u.Z)(t);function t(){var n;(0,s.Z)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r.call.apply(r,[this].concat(o)),e((0,l.Z)(n)),n}return(0,d.Z)(t)}(n);return{F:r,d:[{kind:"field",decorators:[(0,g.Cb)()],key:"header",value:void 0},{kind:"field",decorators:[(0,g.Cb)({type:Boolean,reflect:!0})],key:"raised",value:function(){return!1}},{kind:"get",static:!0,key:"styles",value:function(){return(0,h.iv)(t||(t=(0,i.Z)(["\n      :host {\n        background: var(\n          --ha-card-background,\n          var(--card-background-color, white)\n        );\n        box-shadow: var(--ha-card-box-shadow, none);\n        box-sizing: border-box;\n        border-radius: var(--ha-card-border-radius, 12px);\n        border-width: var(--ha-card-border-width, 1px);\n        border-style: solid;\n        border-color: var(\n          --ha-card-border-color,\n          var(--divider-color, #e0e0e0)\n        );\n        color: var(--primary-text-color);\n        display: block;\n        transition: all 0.3s ease-out;\n        position: relative;\n      }\n\n      :host([raised]) {\n        border: none;\n        box-shadow: var(\n          --ha-card-box-shadow,\n          0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n          0px 1px 1px 0px rgba(0, 0, 0, 0.14),\n          0px 1px 3px 0px rgba(0, 0, 0, 0.12)\n        );\n      }\n\n      .card-header,\n      :host ::slotted(.card-header) {\n        color: var(--ha-card-header-color, --primary-text-color);\n        font-family: var(--ha-card-header-font-family, inherit);\n        font-size: var(--ha-card-header-font-size, 24px);\n        letter-spacing: -0.012em;\n        line-height: 48px;\n        padding: 12px 16px 16px;\n        display: block;\n        margin-block-start: 0px;\n        margin-block-end: 0px;\n        font-weight: normal;\n      }\n\n      :host ::slotted(.card-content:not(:first-child)),\n      slot:not(:first-child)::slotted(.card-content) {\n        padding-top: 0px;\n        margin-top: -8px;\n      }\n\n      :host ::slotted(.card-content) {\n        padding: 16px;\n      }\n\n      :host ::slotted(.card-actions) {\n        border-top: 1px solid var(--divider-color, #e8e8e8);\n        padding: 5px 16px;\n      }\n    "])))}},{kind:"method",key:"render",value:function(){return(0,h.dy)(a||(a=(0,i.Z)(["\n      ","\n      <slot></slot>\n    "])),this.header?(0,h.dy)(o||(o=(0,i.Z)(['<h1 class="card-header">',"</h1>"])),this.header):h.Ld)}}]}}),h.oi)},7171:function(e,n,r){r.r(n),r.d(n,{KNXProjectView:function(){return $}});var t,a,o,i,d,s,l,c,u,p,h,g,v,b,f=r(2746),k=r(8962),x=r(3368),y=r(1650),w=r(2390),_=r(9205),m=r(906),Z=r(1565),j=(r(7393),r(1357),r(3314),r(6798),r(4570),r(733),r(4997),r(9849),r(2148),r(2073),r(271),r(163),r(6513),r(8144)),A=r(5123),R=r(4516),z=(r(4776),r(657),r(8336),r(6291),r(2828),r(4541)),C=r(7838),S=(r(289),r(4167),r(6349),r(320),r(5974),r(2859),r(3448)),O=r(8394),H=r(6133),M=new H.r("knx-project-tree-view"),B=((0,Z.Z)([(0,A.Mo)("knx-project-tree-view")],(function(e,n){var r=function(n){(0,_.Z)(t,n);var r=(0,m.Z)(t);function t(){var n;(0,y.Z)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r.call.apply(r,[this].concat(o)),e((0,w.Z)(n)),n}return(0,x.Z)(t)}(n);return{F:r,d:[{kind:"field",decorators:[(0,A.Cb)({attribute:!1})],key:"data",value:void 0},{kind:"field",decorators:[(0,A.Cb)({attribute:!1})],key:"multiselect",value:function(){return!1}},{kind:"field",decorators:[(0,A.SB)()],key:"_selectableRanges",value:function(){return{}}},{kind:"method",key:"connectedCallback",value:function(){var e=this;(0,z.Z)((0,C.Z)(r.prototype),"connectedCallback",this).call(this);!function n(r){Object.entries(r).forEach((function(r){var t=(0,f.Z)(r,2),a=t[0],o=t[1];o.group_addresses.length>0&&(e._selectableRanges[a]={selected:!1,groupAddresses:o.group_addresses}),n(o.group_ranges)}))}(this.data.group_ranges),M.debug("ranges",this._selectableRanges)}},{kind:"method",key:"render",value:function(){return(0,j.dy)(t||(t=(0,k.Z)(['<div class="ha-tree-view">',"</div>"])),this._recurseData(this.data.group_ranges))}},{kind:"method",key:"_recurseData",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=Object.entries(e).map((function(e){var t=(0,f.Z)(e,2),d=t[0],s=t[1],l=Object.keys(s.group_ranges).length>0;if(!(l||s.group_addresses.length>0))return j.Ld;var c=d in n._selectableRanges,u=!!c&&n._selectableRanges[d].selected,p={"range-item":!0,"root-range":0===r,"sub-range":r>0,selectable:c,"selected-range":u,"non-selected-range":c&&!u},h=(0,j.dy)(a||(a=(0,k.Z)(["<div\n        class=","\n        toggle-range=","\n        @click=",'\n      >\n        <span class="range-key">','</span>\n        <span class="range-text">',"</span>\n      </div>"])),(0,S.$)(p),c?d:j.Ld,c?n.multiselect?n._selectionChangedMulti:n._selectionChangedSingle:j.Ld,d,s.name);if(l){var g={"root-group":0===r,"sub-group":0!==r};return(0,j.dy)(o||(o=(0,k.Z)(["<div class=",">\n          "," ","\n        </div>"])),(0,S.$)(g),h,n._recurseData(s.group_ranges,r+1))}return(0,j.dy)(i||(i=(0,k.Z)(["",""])),h)}));return(0,j.dy)(d||(d=(0,k.Z)(["",""])),t)}},{kind:"method",key:"_selectionChangedMulti",value:function(e){var n=e.target.getAttribute("toggle-range");this._selectableRanges[n].selected=!this._selectableRanges[n].selected,this._selectionUpdate(),this.requestUpdate()}},{kind:"method",key:"_selectionChangedSingle",value:function(e){var n=e.target.getAttribute("toggle-range"),r=this._selectableRanges[n].selected;Object.values(this._selectableRanges).forEach((function(e){e.selected=!1})),this._selectableRanges[n].selected=!r,this._selectionUpdate(),this.requestUpdate()}},{kind:"method",key:"_selectionUpdate",value:function(){var e=Object.values(this._selectableRanges).reduce((function(e,n){return n.selected?e.concat(n.groupAddresses):e}),[]);M.debug("selection changed",e),(0,O.B)(this,"knx-group-range-selection-changed",{groupAddresses:e})}},{kind:"get",static:!0,key:"styles",value:function(){return(0,j.iv)(s||(s=(0,k.Z)(["\n      :host {\n        margin: 0;\n        height: 100%;\n        overflow-y: scroll;\n        overflow-x: hidden;\n        background-color: var(--card-background-color);\n      }\n\n      .ha-tree-view {\n        cursor: default;\n      }\n\n      .root-group {\n        margin-bottom: 8px;\n      }\n\n      .root-group > * {\n        padding-top: 5px;\n        padding-bottom: 5px;\n      }\n\n      .range-item {\n        display: block;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        font-size: 0.875rem;\n      }\n\n      .range-item > * {\n        vertical-align: middle;\n        pointer-events: none;\n      }\n\n      .range-key {\n        color: var(--text-primary-color);\n        font-size: 0.75rem;\n        font-weight: 700;\n        background-color: var(--label-badge-grey);\n        border-radius: 4px;\n        padding: 1px 4px;\n        margin-right: 2px;\n      }\n\n      .root-range {\n        padding-left: 8px;\n        font-weight: 500;\n        background-color: var(--secondary-background-color);\n\n        & .range-key {\n          color: var(--primary-text-color);\n          background-color: var(--card-background-color);\n        }\n      }\n\n      .sub-range {\n        padding-left: 13px;\n      }\n\n      .selectable {\n        cursor: pointer;\n      }\n\n      .selectable:hover {\n        background-color: rgba(var(--rgb-primary-text-color), 0.04);\n      }\n\n      .selected-range {\n        background-color: rgba(var(--rgb-primary-color), 0.12);\n\n        & .range-key {\n          background-color: var(--primary-color);\n        }\n      }\n\n      .selected-range:hover {\n        background-color: rgba(var(--rgb-primary-color), 0.07);\n      }\n\n      .non-selected-range {\n        background-color: var(--card-background-color);\n      }\n    "])))}}]}}),j.oi),r(6775)),L=(r(1467),r(6308),r(1989),r(3789),r(8098),r(7392),/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i),U=function(e){if("string"!=typeof e)throw new TypeError("Invalid argument expected string");var n=e.match(L);if(!n)throw new Error("Invalid argument not valid semver ('".concat(e,"' received)"));return n.shift(),n},E=function(e){return"*"===e||"x"===e||"X"===e},G=function(e){var n=parseInt(e,10);return isNaN(n)?e:n},V=function(e,n){if(E(e)||E(n))return 0;var r=function(e,n){return(0,B.Z)(e)!==(0,B.Z)(n)?[String(e),String(n)]:[e,n]}(G(e),G(n)),t=(0,f.Z)(r,2),a=t[0],o=t[1];return a>o?1:a<o?-1:0},F=function(e,n){for(var r=0;r<Math.max(e.length,n.length);r++){var t=V(e[r]||"0",n[r]||"0");if(0!==t)return t}return 0},I=function(e,n,r){N(r);var t=function(e,n){var r=U(e),t=U(n),a=r.pop(),o=t.pop(),i=F(r,t);return 0!==i?i:a&&o?F(a.split("."),o.split(".")):a||o?a?-1:1:0}(e,n);return q[r].includes(t)},q={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1],"!=":[-1,1]},D=Object.keys(q),N=function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got ".concat((0,B.Z)(e)));if(-1===D.indexOf(e))throw new Error("Invalid operator, expected one of ".concat(D.join("|")))},P=new H.r("knx-project-view"),$=(0,Z.Z)([(0,A.Mo)("knx-project-view")],(function(e,n){var r=function(n){(0,_.Z)(t,n);var r=(0,m.Z)(t);function t(){var n;(0,y.Z)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return n=r.call.apply(r,[this].concat(o)),e((0,w.Z)(n)),n}return(0,x.Z)(t)}(n);return{F:r,d:[{kind:"field",decorators:[(0,A.Cb)({type:Object})],key:"hass",value:void 0},{kind:"field",decorators:[(0,A.Cb)({attribute:!1})],key:"knx",value:void 0},{kind:"field",decorators:[(0,A.Cb)({type:Boolean,reflect:!0})],key:"narrow",value:void 0},{kind:"field",decorators:[(0,A.Cb)({type:Object})],key:"route",value:void 0},{kind:"field",decorators:[(0,A.Cb)({type:Array,reflect:!1})],key:"tabs",value:void 0},{kind:"field",decorators:[(0,A.Cb)({type:Boolean,reflect:!0})],key:"rangeSelectorHidden",value:function(){return!0}},{kind:"field",decorators:[(0,A.SB)()],key:"_visibleGroupAddresses",value:function(){return[]}},{kind:"field",decorators:[(0,A.SB)()],key:"_groupRangeAvailable",value:function(){return!1}},{kind:"method",key:"firstUpdated",value:function(){var e=this;this.knx.project?this._isGroupRangeAvailable():this.knx.loadProject().then((function(){e._isGroupRangeAvailable(),e.requestUpdate()}))}},{kind:"method",key:"_isGroupRangeAvailable",value:function(){var e,n,r=null!==(e=null===(n=this.knx.project)||void 0===n?void 0:n.knxproject.info.xknxproject_version)&&void 0!==e?e:"0.0.0";P.debug("project version: "+r),this._groupRangeAvailable=I(r,"3.3.0",">=")}},{kind:"field",key:"_columns",value:function(){var e=this;return(0,R.Z)((function(n,r){var t="100px",a="82px";return{address:{filterable:!0,sortable:!0,title:e.knx.localize("project_view_table_address"),width:t},name:{filterable:!0,sortable:!0,title:e.knx.localize("project_view_table_name"),width:n?"calc(100% - 82px - 100px)":"calc(50% - 82px)"},description:{filterable:!0,sortable:!0,hidden:n,title:e.knx.localize("project_view_table_description"),width:"calc(50% - 100px)"},dpt:{sortable:!0,filterable:!0,title:e.knx.localize("project_view_table_dpt"),width:a,template:function(e){return e.dpt?(0,j.dy)(l||(l=(0,k.Z)(['<span style="display:inline-block;width:24px;text-align:right;"\n                  >',"</span\n                >"," "])),e.dpt.main,e.dpt.sub?"."+e.dpt.sub.toString().padStart(3,"0"):""):""}}}}))}},{kind:"method",key:"_getRows",value:function(e){return e.length?Object.entries(this.knx.project.knxproject.group_addresses).reduce((function(n,r){var t=(0,f.Z)(r,2),a=t[0],o=t[1];return e.includes(a)&&n.push(o),n}),[]):Object.values(this.knx.project.knxproject.group_addresses)}},{kind:"method",key:"_visibleAddressesChanged",value:function(e){this._visibleGroupAddresses=e.detail.groupAddresses}},{kind:"method",key:"render",value:function(){if(!this.hass||!this.knx.project)return(0,j.dy)(c||(c=(0,k.Z)([" <hass-loading-screen></hass-loading-screen> "])));var e=this._getRows(this._visibleGroupAddresses);return(0,j.dy)(u||(u=(0,k.Z)(["\n      <hass-tabs-subpage\n        .hass=","\n        .narrow=","\n        .route=","\n        .tabs=","\n        .localizeFunc=","\n      >\n        ","\n      </hass-tabs-subpage>\n    "])),this.hass,this.narrow,this.route,this.tabs,this.knx.localize,this.knx.project.project_loaded?(0,j.dy)(p||(p=(0,k.Z)(["",'\n              <div class="sections">\n                ','\n                <ha-data-table\n                  class="ga-table"\n                  .hass=',"\n                  .columns=","\n                  .data=","\n                  .hasFab=","\n                  .searchLabel=","\n                  .clickable=","\n                ></ha-data-table>\n              </div>"])),this.narrow&&this._groupRangeAvailable?(0,j.dy)(h||(h=(0,k.Z)(['<ha-icon-button\n                    slot="toolbar-icon"\n                    .label=',"\n                    .path=","\n                    @click=","\n                  ></ha-icon-button>"])),this.hass.localize("ui.components.related-filter-menu.filter"),"M6,13H18V11H6M3,6V8H21V6M10,18H14V16H10V18Z",this._toggleRangeSelector):j.Ld,this._groupRangeAvailable?(0,j.dy)(g||(g=(0,k.Z)(["\n                      <knx-project-tree-view\n                        .data=","\n                        @knx-group-range-selection-changed=","\n                      ></knx-project-tree-view>\n                    "])),this.knx.project.knxproject,this._visibleAddressesChanged):j.Ld,this.hass,this._columns(this.narrow,this.hass.language),e,!1,this.hass.localize("ui.components.data-table.search"),!1):(0,j.dy)(v||(v=(0,k.Z)([" <ha-card .header=",'>\n              <div class="card-content">\n                <p>',"</p>\n              </div>\n            </ha-card>"])),this.knx.localize("attention"),this.knx.localize("project_view_upload")))}},{kind:"method",key:"_toggleRangeSelector",value:function(){this.rangeSelectorHidden=!this.rangeSelectorHidden}},{kind:"get",static:!0,key:"styles",value:function(){return(0,j.iv)(b||(b=(0,k.Z)(["\n      hass-loading-screen {\n        --app-header-background-color: var(--sidebar-background-color);\n        --app-header-text-color: var(--sidebar-text-color);\n      }\n      .sections {\n        display: flex;\n        flex-direction: row;\n        height: 100%;\n      }\n\n      :host([narrow]) knx-project-tree-view {\n        position: absolute;\n        max-width: calc(100% - 60px); /* 100% -> max 871px before not narrow */\n        z-index: 1;\n        right: 0;\n        transition: 0.5s;\n        border-left: 1px solid var(--divider-color);\n      }\n\n      :host([narrow][rangeSelectorHidden]) knx-project-tree-view {\n        width: 0;\n      }\n\n      :host(:not([narrow])) knx-project-tree-view {\n        max-width: 255px; /* min 616px - 816px for tree-view + ga-table (depending on side menu) */\n      }\n\n      .ga-table {\n        flex: 1;\n      }\n    "])))}}]}}),j.oi)},3359:function(e,n,r){r.d(n,{Z:function(){return a}});var t=r(7292);function a(e,n,r){return(n=(0,t.Z)(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}}}]);