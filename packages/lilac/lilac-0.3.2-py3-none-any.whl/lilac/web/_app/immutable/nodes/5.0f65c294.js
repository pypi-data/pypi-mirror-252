import{S as pe,i as ge,s as be,k as y,a as A,l as R,m as C,c as H,h as p,n as q,b as $,a0 as T,g as k,v as G,d as D,f as K,O as x,y as M,z as W,A as z,B as J,q as F,e as ee,r as P,u as X,a1 as Z,ab as Q,w as Ie,U as $e,V as De}from"../chunks/index.ad1b71d6.js";import{b as Ee,P as Te}from"../chunks/Page.d78f217d.js";import{g as Ve}from"../chunks/navigation.2146f391.js";import{c as Ne,R as ye}from"../chunks/DatasetSettingsFields.3fd858eb.js";import{b0 as Re,be as Ce,bb as Fe,q as Pe,aj as qe,a8 as Oe,ab as Le,ac as Be,aU as Ue,ae as ne,ak as Ae,ao as He,E as Me,am as We,an as ze,D as Je,ah as je,c as Ge}from"../chunks/Commands.597b0ae1.js";import{T as he}from"../chunks/ToastNotification.9069cf03.js";function re(l){let s,t;return s=new he({props:{hideCloseButton:!0,kind:"warning",fullWidth:!0,lowContrast:!0,title:"Unknown task",caption:"This could be from a stale link, or a new server instance."}}),{c(){M(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},i(e){t||(k(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function oe(l){let s,t,e,i,n,a,f,o,r,g,_,b,h,E,S,d=l[3].status==="error"&&fe(l),u=l[3].status!="error"&&ue(l);const m=[Xe,Ke],v=[];function O(c,w){return c[3].status=="completed"?0:c[3].status==="error"?1:-1}return~(b=O(l))&&(h=v[b]=m[b](l)),{c(){s=y("section"),t=y("div"),e=F('Step 1: Load dataset "'),i=F(l[0]),n=F("/"),a=F(l[1]),f=F('"'),o=A(),r=y("div"),d&&d.c(),g=A(),u&&u.c(),_=A(),h&&h.c(),E=ee(),this.h()},l(c){s=R(c,"SECTION",{class:!0});var w=C(s);t=R(w,"DIV",{class:!0});var V=C(t);e=P(V,'Step 1: Load dataset "'),i=P(V,l[0]),n=P(V,"/"),a=P(V,l[1]),f=P(V,'"'),V.forEach(p),o=H(w),r=R(w,"DIV",{class:!0});var j=C(r);d&&d.l(j),j.forEach(p),g=H(w),u&&u.l(w),w.forEach(p),_=H(c),h&&h.l(c),E=ee(),this.h()},h(){q(t,"class","text-2xl text-gray-700"),q(r,"class","text-base"),q(s,"class","flex flex-col gap-y-2")},m(c,w){$(c,s,w),T(s,t),T(t,e),T(t,i),T(t,n),T(t,a),T(t,f),T(s,o),T(s,r),d&&d.m(r,null),T(s,g),u&&u.m(s,null),$(c,_,w),~b&&v[b].m(c,w),$(c,E,w),S=!0},p(c,w){(!S||w&1)&&X(i,c[0]),(!S||w&2)&&X(a,c[1]),c[3].status==="error"?d?d.p(c,w):(d=fe(c),d.c(),d.m(r,null)):d&&(d.d(1),d=null),c[3].status!="error"?u?(u.p(c,w),w&8&&k(u,1)):(u=ue(c),u.c(),k(u,1),u.m(s,null)):u&&(G(),D(u,1,1,()=>{u=null}),K());let V=b;b=O(c),b===V?~b&&v[b].p(c,w):(h&&(G(),D(v[V],1,1,()=>{v[V]=null}),K()),~b?(h=v[b],h?h.p(c,w):(h=v[b]=m[b](c),h.c()),k(h,1),h.m(E.parentNode,E)):h=null)},i(c){S||(k(u),k(h),S=!0)},o(c){D(u),D(h),S=!1},d(c){c&&p(s),d&&d.d(),u&&u.d(),c&&p(_),~b&&v[b].d(c),c&&p(E)}}}function fe(l){let s,t,e,i;return{c(){s=F("Error loading "),t=F(l[0]),e=F("/"),i=F(l[1])},l(n){s=P(n,"Error loading "),t=P(n,l[0]),e=P(n,"/"),i=P(n,l[1])},m(n,a){$(n,s,a),$(n,t,a),$(n,e,a),$(n,i,a)},p(n,a){a&1&&X(t,n[0]),a&2&&X(i,n[1])},d(n){n&&p(s),n&&p(t),n&&p(e),n&&p(i)}}}function ue(l){var f,o;let s,t,e,i,n;t=new Ee({props:{labelText:l[3].message||"",helperText:l[3].status!="completed"?l[3].details||void 0:"",value:l[3].status==="completed"?1:l[6],max:1,status:l[17][l[3].status]}});let a=((o=(f=l[5])==null?void 0:f.data)==null?void 0:o.total_num_rows)!=null&&de(l);return{c(){s=y("div"),M(t.$$.fragment),e=A(),i=y("div"),a&&a.c(),this.h()},l(r){s=R(r,"DIV",{class:!0});var g=C(s);W(t.$$.fragment,g),g.forEach(p),e=H(r),i=R(r,"DIV",{class:!0});var _=C(i);a&&a.l(_),_.forEach(p),this.h()},h(){q(s,"class","mt-2"),q(i,"class","text-sm text-gray-700")},m(r,g){$(r,s,g),z(t,s,null),$(r,e,g),$(r,i,g),a&&a.m(i,null),n=!0},p(r,g){var b,h;const _={};g&8&&(_.labelText=r[3].message||""),g&8&&(_.helperText=r[3].status!="completed"?r[3].details||void 0:""),g&72&&(_.value=r[3].status==="completed"?1:r[6]),g&8&&(_.status=r[17][r[3].status]),t.$set(_),((h=(b=r[5])==null?void 0:b.data)==null?void 0:h.total_num_rows)!=null?a?a.p(r,g):(a=de(r),a.c(),a.m(i,null)):a&&(a.d(1),a=null)},i(r){n||(k(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){r&&p(s),J(t),r&&p(e),r&&p(i),a&&a.d()}}}function de(l){var i,n;let s=((n=(i=l[5])==null?void 0:i.data)==null?void 0:n.total_num_rows.toLocaleString())+"",t,e;return{c(){t=F(s),e=F(" rows loaded")},l(a){t=P(a,s),e=P(a," rows loaded")},m(a,f){$(a,t,f),$(a,e,f)},p(a,f){var o,r;f&32&&s!==(s=((r=(o=a[5])==null?void 0:o.data)==null?void 0:r.total_num_rows.toLocaleString())+"")&&X(t,s)},d(a){a&&p(t),a&&p(e)}}}function Ke(l){let s,t;return s=new he({props:{hideCloseButton:!0,kind:"error",fullWidth:!0,lowContrast:!0,title:"Error loading dataset",caption:l[3].error||void 0}}),{c(){M(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,i){const n={};i&8&&(n.caption=e[3].error||void 0),s.$set(n)},i(e){t||(k(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function Xe(l){let s,t,e,i,n,a,f,o,r,g,_,b,h,E,S,d=l[2]&&ce(l),u=l[9]!=null&&me(l);return E=new Je({props:{disabled:l[2]==null,size:"xl",icon:je,iconDescription:"Open dataset",$$slots:{default:[Ye]},$$scope:{ctx:l}}}),E.$on("click",l[26]),{c(){s=y("div"),t=y("section"),e=y("div"),i=y("div"),n=F("Step 2: Choose settings"),a=A(),f=y("div"),o=F("These settings can be changed from the dataset page at any time."),r=A(),d&&d.c(),g=A(),_=y("div"),u&&u.c(),b=A(),h=y("div"),M(E.$$.fragment),this.h()},l(m){s=R(m,"DIV",{class:!0});var v=C(s);t=R(v,"SECTION",{class:!0});var O=C(t);e=R(O,"DIV",{class:!0});var c=C(e);i=R(c,"DIV",{class:!0});var w=C(i);n=P(w,"Step 2: Choose settings"),w.forEach(p),a=H(c),f=R(c,"DIV",{class:!0});var V=C(f);o=P(V,"These settings can be changed from the dataset page at any time."),V.forEach(p),c.forEach(p),r=H(O),d&&d.l(O),O.forEach(p),v.forEach(p),g=H(m),_=R(m,"DIV",{});var j=C(_);u&&u.l(j),j.forEach(p),b=H(m),h=R(m,"DIV",{class:!0});var N=C(h);W(E.$$.fragment,N),N.forEach(p),this.h()},h(){q(i,"class","text-2xl text-gray-700"),q(f,"class","text-sm text-gray-500"),q(e,"class","flex flex-col gap-y-2"),q(t,"class","flex flex-col gap-y-4"),q(s,"class","my-8"),q(h,"class","dataset-link mt-8")},m(m,v){$(m,s,v),T(s,t),T(t,e),T(e,i),T(i,n),T(e,a),T(e,f),T(f,o),T(t,r),d&&d.m(t,null),$(m,g,v),$(m,_,v),u&&u.m(_,null),$(m,b,v),$(m,h,v),z(E,h,null),S=!0},p(m,v){m[2]?d?(d.p(m,v),v&4&&k(d,1)):(d=ce(m),d.c(),k(d,1),d.m(t,null)):d&&(G(),D(d,1,1,()=>{d=null}),K()),m[9]!=null?u?(u.p(m,v),v&512&&k(u,1)):(u=me(m),u.c(),k(u,1),u.m(_,null)):u&&(G(),D(u,1,1,()=>{u=null}),K());const O={};v&4&&(O.disabled=m[2]==null),v&268435456&&(O.$$scope={dirty:v,ctx:m}),E.$set(O)},i(m){S||(k(d),k(u),k(E.$$.fragment,m),S=!0)},o(m){D(d),D(u),D(E.$$.fragment,m),S=!1},d(m){m&&p(s),d&&d.d(),m&&p(g),m&&p(_),u&&u.d(),m&&p(b),m&&p(h),J(E)}}}function ce(l){let s,t,e;function i(a){l[25](a)}let n={namespace:l[0],datasetName:l[1]};return l[2]!==void 0&&(n.newSettings=l[2]),s=new Ne({props:n}),Ie.push(()=>$e(s,"newSettings",i)),{c(){M(s.$$.fragment)},l(a){W(s.$$.fragment,a)},m(a,f){z(s,a,f),e=!0},p(a,f){const o={};f&1&&(o.namespace=a[0]),f&2&&(o.datasetName=a[1]),!t&&f&4&&(t=!0,o.newSettings=a[2],De(()=>t=!1)),s.$set(o)},i(a){e||(k(s.$$.fragment,a),e=!0)},o(a){D(s.$$.fragment,a),e=!1},d(a){J(s,a)}}}function me(l){var a,f;let s,t,e,i,n;return i=new ye({props:{rowId:l[9],index:0,totalNumRows:(f=(a=l[5])==null?void 0:a.data)==null?void 0:f.total_num_rows,mediaFields:l[7],highlightedFields:l[8]}}),{c(){s=y("div"),t=F("Preview"),e=A(),M(i.$$.fragment),this.h()},l(o){s=R(o,"DIV",{class:!0});var r=C(s);t=P(r,"Preview"),r.forEach(p),e=H(o),W(i.$$.fragment,o),this.h()},h(){q(s,"class","text-xl text-gray-700")},m(o,r){$(o,s,r),T(s,t),$(o,e,r),z(i,o,r),n=!0},p(o,r){var _,b;const g={};r&512&&(g.rowId=o[9]),r&32&&(g.totalNumRows=(b=(_=o[5])==null?void 0:_.data)==null?void 0:b.total_num_rows),r&128&&(g.mediaFields=o[7]),r&256&&(g.highlightedFields=o[8]),i.$set(g)},i(o){n||(k(i.$$.fragment,o),n=!0)},o(o){D(i.$$.fragment,o),n=!1},d(o){o&&p(s),o&&p(e),J(i,o)}}}function Ye(l){let s;return{c(){s=F("Save and open dataset")},l(t){s=P(t,"Save and open dataset")},m(t,e){$(t,s,e)},d(t){t&&p(s)}}}function Ze(l){let s,t,e,i,n=l[4].isSuccess&&l[3]==null&&re(),a=l[3]&&oe(l);return{c(){s=y("div"),t=y("div"),n&&n.c(),e=A(),a&&a.c(),this.h()},l(f){s=R(f,"DIV",{class:!0});var o=C(s);t=R(o,"DIV",{class:!0});var r=C(t);n&&n.l(r),e=H(r),a&&a.l(r),r.forEach(p),o.forEach(p),this.h()},h(){q(t,"class","center-panel mx-auto p-8 svelte-af9918"),q(s,"class","w-full overflow-y-scroll")},m(f,o){$(f,s,o),T(s,t),n&&n.m(t,null),T(t,e),a&&a.m(t,null),i=!0},p(f,[o]){f[4].isSuccess&&f[3]==null?n?o&24&&k(n,1):(n=re(),n.c(),k(n,1),n.m(t,e)):n&&(G(),D(n,1,1,()=>{n=null}),K()),f[3]?a?(a.p(f,o),o&8&&k(a,1)):(a=oe(f),a.c(),k(a,1),a.m(t,null)):a&&(G(),D(a,1,1,()=>{a=null}),K())},i(f){i||(k(n),k(a),i=!0)},o(f){D(n),D(a),i=!1},d(f){f&&p(s),n&&n.d(),a&&a.d()}}}function Qe(l,s,t){let e,i,n,a,f,o,r,g,_,b,h,E,S,d=Z,u=()=>(d(),d=Q(n,I=>t(21,S=I)),n),m,v=Z,O=()=>(v(),v=Q(a,I=>t(22,m=I)),a),c,w,V=Z,j=()=>(V(),V=Q(f,I=>t(5,w=I)),f),N,te=Z,we=()=>(te(),te=Q(i,I=>t(24,N=I)),i);l.$$.on_destroy.push(()=>d()),l.$$.on_destroy.push(()=>v()),l.$$.on_destroy.push(()=>V()),l.$$.on_destroy.push(()=>te());let{namespace:L}=s,{datasetName:B}=s,{loadingTaskId:Y}=s,U;const le=Re();x(l,le,I=>t(27,h=I));const se=Ce(L,B);x(l,se,I=>t(23,c=I)),Fe(se);const ae=Pe();x(l,ae,I=>t(4,E=I));const ve={pending:"active",completed:"finished",error:"error"};function ie(){U!=null&&h.mutate([L,B,U],{onSuccess:()=>{Ve(Me(L,B))}})}function ke(I){U=I,t(2,U),t(24,N)}const Se=()=>ie();return l.$$set=I=>{"namespace"in I&&t(0,L=I.namespace),"datasetName"in I&&t(1,B=I.datasetName),"loadingTaskId"in I&&t(19,Y=I.loadingTaskId)},l.$$.update=()=>{l.$$.dirty&524304&&t(3,_=Y!=null&&E.data!=null?E.data.tasks[Y]:null),l.$$.dirty&8&&t(20,e=(_==null?void 0:_.status)=="completed"),l.$$.dirty&1048579&&we(t(13,i=e?qe(L,B):null)),l.$$.dirty&16777220&&t(2,U=N!=null&&N.isFetching||(N==null?void 0:N.data)==null?null:U??JSON.parse(JSON.stringify(N==null?void 0:N.data))),l.$$.dirty&1048579&&u(t(12,n=e?Oe(L,B):null)),l.$$.dirty&11534339&&O(t(11,a=e?Le(L,B,Be(c,S==null?void 0:S.data)):null)),l.$$.dirty&2097155&&j(t(10,f=L&&B&&(S==null?void 0:S.data)!=null?Ue(L,B,{columns:[ne],limit:1,combine_columns:!0},S.data):null)),l.$$.dirty&32&&t(9,o=(w==null?void 0:w.data)!=null?We.value(ze(w.data.rows[0],[ne]),"string"):null),l.$$.dirty&12582912&&t(8,r=Ae(c.query,m==null?void 0:m.data)),l.$$.dirty&2097156&&t(7,g=U!=null&&(S==null?void 0:S.data)!=null?He(S==null?void 0:S.data,U):[]),l.$$.dirty&8&&t(6,b=(_==null?void 0:_.total_progress)!=null&&(_==null?void 0:_.total_len)!=null?_.total_progress/_.total_len:void 0)},[L,B,U,_,E,w,b,g,r,o,f,a,n,i,le,se,ae,ve,ie,Y,e,S,m,c,N,ke,Se]}class xe extends pe{constructor(s){super(),ge(this,s,Qe,Ze,be,{namespace:0,datasetName:1,loadingTaskId:19})}}function _e(l){let s,t;return s=new xe({props:{namespace:l[0],datasetName:l[1],loadingTaskId:l[2]}}),{c(){M(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,i){const n={};i&1&&(n.namespace=e[0]),i&2&&(n.datasetName=e[1]),i&4&&(n.loadingTaskId=e[2]),s.$set(n)},i(e){t||(k(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function et(l){let s,t,e=l[0]!=null&&l[1]!=null&&l[2]!=null&&_e(l);return{c(){e&&e.c(),s=ee()},l(i){e&&e.l(i),s=ee()},m(i,n){e&&e.m(i,n),$(i,s,n),t=!0},p(i,n){i[0]!=null&&i[1]!=null&&i[2]!=null?e?(e.p(i,n),n&7&&k(e,1)):(e=_e(i),e.c(),k(e,1),e.m(s.parentNode,s)):e&&(G(),D(e,1,1,()=>{e=null}),K())},i(i){t||(k(e),t=!0)},o(i){D(e),t=!1},d(i){e&&e.d(i),i&&p(s)}}}function tt(l){let s,t;return s=new Te({props:{$$slots:{default:[et]},$$scope:{ctx:l}}}),{c(){M(s.$$.fragment)},l(e){W(s.$$.fragment,e)},m(e,i){z(s,e,i),t=!0},p(e,[i]){const n={};i&39&&(n.$$scope={dirty:i,ctx:e}),s.$set(n)},i(e){t||(k(s.$$.fragment,e),t=!0)},o(e){D(s.$$.fragment,e),t=!1},d(e){J(s,e)}}}function st(l,s,t){let e,i,n,a;const f=Ge();return x(l,f,o=>t(4,e=o)),l.$$.update=()=>{l.$$.dirty&16&&e.page==="datasets/loading"&&e.identifier!=null&&t(0,[i,n,a]=e.identifier.split("/"),i,(t(1,n),t(4,e)),(t(2,a),t(4,e)))},[i,n,a,f,e]}class ft extends pe{constructor(s){super(),ge(this,s,st,tt,be,{})}}export{ft as component};
