"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4436],{8535:(e,t,a)=>{var r=a(47169),i=a(63025),n=a(45709),s=a(60216),c=a.n(s),o=a(32735),l=a(12788),u=a(85204),d=a(25591),m=a(5212),p=a(69184),y=a(37314),f=a(67986),D=a(48060),g=a(8892),b=a(33344),v=a(19306),E=a(59090);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const O=i.ZP.bind(null,{endpoint:"users.profile_picture_preview",rules:[{args:["source","user_id"],converters:{source:"AnyConverter",user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"profile",isDynamic:!1},{data:"/",isDynamic:!1},{data:"picture",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1},{data:"/",isDynamic:!1},{data:"source",isDynamic:!0}]},{args:["source"],converters:{source:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"profile",isDynamic:!1},{data:"/",isDynamic:!1},{data:"picture",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1},{data:"/",isDynamic:!1},{data:"source",isDynamic:!0}]}]},"/"),w=i.ZP.bind(null,{endpoint:"users.save_profile_picture",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"profile",isDynamic:!1},{data:"/",isDynamic:!1},{data:"picture",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"profile",isDynamic:!1},{data:"/",isDynamic:!1},{data:"picture",isDynamic:!1}]}]},"/");function h(e){let{image:t,text:a,email:r,children:i,source:n}=e;const{input:{onChange:s,value:c}}=(0,d.useField)("source"),l=c===n;return o.createElement(m.Z,{color:l?"blue":null,onClick:()=>s(n),style:l?{backgroundColor:"#f5f5f5"}:null},o.createElement(m.Z.Description,null,t?o.createElement(p.Z,{src:t,circular:!0,size:"tiny"}):o.createElement(y.Z,{name:"question circle outline",size:"huge",className:"users-client-js-___ProfilePicture-module__placeholder___XTBq-"}),a),r&&o.createElement(g.TooltipIfTruncated,{useEventTarget:!0},o.createElement(m.Z.Content,{extra:!0},o.createElement(v.Translate,null,"Based on ",o.createElement(v.Param,{name:"email",value:r})))),i&&o.createElement(m.Z.Content,{extra:!0},i))}function C(e){let{onFileSelected:t}=e;const{submitting:a}=(0,d.useFormState)({subscription:{submitting:!0}}),{input:{onChange:r}}=(0,d.useField)("file",{allowNull:!0}),{getRootProps:i,getInputProps:n,open:s}=(0,u.uI)({onDropAccepted:e=>{let[a]=e;t(a),r(a)},multiple:!1,noClick:!0,noKeyboard:!0,accept:[".jpg",".png",".gif",".webp"],disabled:a});return o.createElement("section",null,o.createElement("div",i(),o.createElement("input",n()),o.createElement(f.Z,{disabled:a,type:"button",icon:"upload",content:v.Translate.string("Upload"),size:"small",onClick:e=>{e.stopPropagation(),s()}})))}h.propTypes={image:c().string,text:c().string.isRequired,email:c().string,children:c().node,source:c().oneOf(["standard","identicon","gravatar","custom"]).isRequired},h.defaultProps={image:null,email:null,children:null},C.propTypes={onFileSelected:c().func.isRequired};const j=(0,n.Z)({field:"file",updates:e=>null===e?{}:{source:"custom"}});function S(e){let{userId:t,email:a,source:r}=e;const[i,n]=(0,o.useState)(null),[s,c]=(0,o.useState)("custom"===r),l=null!==t?{user_id:t}:{},u=(0,o.useCallback)((e=>{n(e),c(!0)}),[]);return o.createElement("div",{className:"users-client-js-___ProfilePicture-module__profile-picture-selection___YxVGi"},o.createElement(d.Form,{onSubmit:async e=>{const t=new FormData;"custom"===e.source&&t.append("picture",e.file),t.append("source",e.source);const a={headers:{"content-type":"multipart/form-data"}};try{await E.indicoAxios.post(w(l),t,a)}catch(e){return void(0,E.handleAxiosError)(e)}location.reload(),await new Promise((()=>{}))},initialValues:{file:null,source:r},validate:e=>"custom"!==e.source||e.file?{}:{source:"invalid"},subscription:{},decorators:[j]},(e=>o.createElement("div",null,o.createElement(D.Z,{onSubmit:e.handleSubmit},o.createElement(m.Z.Group,{itemsPerRow:4,centered:!0},o.createElement(h,{image:O(P(P({},l),{},{source:"standard"})),text:v.Translate.string("System-assigned icon"),source:"standard"}),o.createElement(h,{image:O(P(P({},l),{},{source:"identicon"})),text:"Identicon",source:"identicon",email:a}),o.createElement(h,{image:O(P(P({},l),{},{source:"gravatar"})),text:"Gravatar",source:"gravatar",email:a}),o.createElement(h,{image:s?i?URL.createObjectURL(i):O(P(P({},l),{},{source:"custom"})):null,text:v.Translate.string("Custom picture"),source:"custom"},o.createElement(C,{onFileSelected:u}))),o.createElement(b.Ei,{label:v.Translate.string("Save changes"),className:"submit-button"}))))))}S.propTypes={userId:c().number,email:c().string.isRequired,source:c().string.isRequired},S.defaultProps={userId:null},window.setupPictureSelection=function(e,t,a){document.addEventListener("DOMContentLoaded",(()=>{l.render(o.createElement(S,{userId:e,email:t,source:a}),document.querySelector("#profile-picture-selection"))}))}}},e=>{e.O(0,[5514,3044,8592],(()=>{return t=8535,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_users.profile_picture.674ca815.bundle.js.map