import{d as C,r as u,w as E,e as c,o as h,m as Q,_ as X,c as p,f as t,g as l,a as d,j as o,F as $,l as B,t as S,k as D,h as Z}from"./index-dHTaJain.js";import{C as ee,_ as te}from"./ChatRecprdsHeader-6ucLwsMd.js";const ae=C({__name:"DateTimeSelect",emits:["datetime"],setup(w,{emit:x}){const m=[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)],f=[{text:"全部",value:()=>{const a=new Date;return[new Date(2010,0,1,0,0,0),a]}},{text:"最近一周",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,a]}},{text:"最近一个月",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,a]}},{text:"最近三个月",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,a]}},{text:"最近半年",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*180),[e,a]}},{text:"最近一年",value:()=>{const a=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*365),[e,a]}},{text:"去年一整年",value:()=>{const a=new Date;a.setFullYear(a.getFullYear()-1),a.setMonth(0),a.setDate(1),a.setHours(0,0,0);const e=new Date;return e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(31),e.setHours(23,59,59),[a,e]}}],_=u([Date,Date]),g=x;return E(()=>_.value,(a,e)=>{let i=a[0].getTime(),v=a[1].getTime();g("datetime",[i,v])}),(a,e)=>{const i=c("el-date-picker");return h(),Q(i,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=v=>_.value=v),type:"datetimerange",shortcuts:f,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":m,format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])}}}),le=X(ae,[["__scopeId","data-v-320582f6"]]),oe={id:"chat_export",style:{"background-color":"#d2d2fa",padding:"0"}},se={style:{"background-color":"#d2d2fa",height:"calc(100vh - 65px)",display:"grid","place-items":"center"}},ne={style:{"background-color":"#fff",width:"70%",height:"70%","border-radius":"10px",padding:"20px",overflow:"auto"}},re=d("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[d("div",{style:{"font-size":"20px","font-weight":"bold"}},"导出与备份(未完待续...）"),d("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}})],-1),ue={style:{"margin-top":"20px"}},ce=d("br",null,null,-1),de=d("br",null,null,-1),ie=d("br",null,null,-1),he={key:0},me={key:1},_e=d("strong",null,"** 时间(默认全部)：",-1),pe={key:2},we={key:3},fe={key:4},ve=C({__name:"ChatExportMain",props:{userData:{type:Object,required:!0}},setup(w){const x=w,m=u(""),f=u([]),_=u(["文本"]),g=u(""),a=u(""),e=u(""),i={endb:{brief:"加密文件",detail:`导出的内容为微信加密数据库（）。
可还原回微信,但会覆盖微信后续消息。`,userShow:!1,timeShow:!1,chatTypeShow:!1,keyShow:!1,wxPathShow:!0},dedb:{brief:"解密文件",detail:"导出的文件为解密后的sqlite数据库，并且会自动合并msg和media数据库为同一个，但是无法还原会微信。",userShow:!1,timeShow:!0,chatTypeShow:!1,keyShow:!1,wxPathShow:!1},csv:{brief:"csv",detail:"只包含文本，但是可以用excel软件（wps，office）打开。",userShow:!0,timeShow:!1,chatTypeShow:!1,keyShow:!1,wxPathShow:!1},json:{brief:"json",detail:"只包含文本，可用于数据分析，情感分析等方面。",userShow:!0,timeShow:!1,chatTypeShow:!1,keyShow:!1,wxPathShow:!1},html:{brief:"html-开发中",detail:"主要用于浏览器可视化查看。",userShow:!0,timeShow:!0,chatTypeShow:!0,keyShow:!1,wxPathShow:!0},pdf:{brief:"pdf-开发中",detail:"就是html的pdf版本。",userShow:!0,timeShow:!0,chatTypeShow:!0,keyShow:!1,wxPathShow:!0},docx:{brief:"docx-开发中",detail:"就是html的docx版本。",userShow:!0,timeShow:!0,chatTypeShow:!0,keyShow:!1,wxPathShow:!0}},v=["文本","图片","语音","视频","动画表情","文件","卡片式链接","用户上传的GIF表情","转账消息","赠送红包封面","语音通话","系统通知","拍一拍","系统通知","其他"],b=u(!1),T=u(!0),I=s=>{_.value=s?v:[],T.value=!1},A=s=>{const r=s.length;b.value=r===v.length,T.value=r>0&&r<v.length},q=s=>{f.value=s},P=u(!1),U=u(!1),F=u(!1),Y=u(!1),j=u(!1);E(m,s=>{P.value=i[s].userShow,U.value=i[s].timeShow,F.value=i[s].chatTypeShow,Y.value=i[s].keyShow,j.value=i[s].wxPathShow,e.value=i[s].detail});const N=async()=>{try{if(m.value===""){e.value="导出类型不能为空";return}const s=await Z.post("/api/export",{export_type:m.value,start_time:f.value[0],end_time:f.value[1],chat_type:_.value,username:x.userData.username,wx_path:a.value});e.value=s}catch(s){console.error("Error fetching data:",s),e.value=String(s)+`
更多信息请查看控制台；`}};return(s,r)=>{const R=c("el-header"),z=c("el-option"),G=c("el-select"),y=c("el-text"),k=c("el-col"),L=c("el-row"),H=c("el-checkbox"),O=c("el-checkbox-group"),V=c("el-input"),W=c("el-button"),J=c("el-divider"),K=c("el-main");return h(),p("div",oe,[t(R,{style:{height:"65px","max-height":"65px",width:"100%","padding-top":"5px"}},{default:l(()=>[t(ee,{userData:w.userData},null,8,["userData"])]),_:1}),t(K,{style:{"overflow-y":"auto",height:"calc(100vh - 65px)",padding:"0"}},{default:l(()=>[d("div",se,[d("div",ne,[re,d("div",ue,[o(" 导出类型: "),t(G,{placeholder:"请选择导出类型",style:{width:"50%"},modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=n=>m.value=n)},{default:l(()=>[(h(),p($,null,B(i,(n,M)=>t(z,{label:n.brief,value:M,key:M},{default:l(()=>[o(S(n.brief),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"]),ce,de,d("div",null,[o(" 选项:"),ie,P.value?(h(),p("div",he,[o(" ** 用户(默认全部，从左边选择具体用户)： "),t(L,{gutter:5,style:{width:"100%"}},{default:l(()=>[t(k,{span:6,style:{"white-space":"nowrap"}},{default:l(()=>[t(y,{class:"label_color mx-1",truncated:""},{default:l(()=>[o("原始id:")]),_:1}),o("  "),t(y,{class:"data_color mx-1",truncated:""},{default:l(()=>[o(S(w.userData.username),1)]),_:1})]),_:1}),t(k,{span:6,style:{"white-space":"nowrap"}},{default:l(()=>[t(y,{class:"label_color mx-1",truncated:""},{default:l(()=>[o("账号:")]),_:1}),o("  "),t(y,{class:"data_color mx-1",truncated:""},{default:l(()=>[o(S(w.userData.account),1)]),_:1})]),_:1}),t(k,{span:6,style:{"white-space":"nowrap"}},{default:l(()=>[t(y,{class:"label_color mx-1",truncated:""},{default:l(()=>[o("昵称:")]),_:1}),o("  "),t(y,{class:"data_color mx-1",truncated:""},{default:l(()=>[o(S(w.userData.nickname),1)]),_:1})]),_:1}),t(k,{span:6,style:{"white-space":"nowrap"}},{default:l(()=>[t(y,{class:"label_color mx-1",truncated:""},{default:l(()=>[o("备注:")]),_:1}),o("  "),t(y,{class:"data_color mx-1",truncated:""},{default:l(()=>[o(S(w.userData.remark),1)]),_:1})]),_:1})]),_:1})])):D("",!0),U.value?(h(),p("div",me,[_e,t(le,{onDatetime:q})])):D("",!0),F.value?(h(),p("div",pe,[o(" ** 消息类型： "),t(H,{modelValue:b.value,"onUpdate:modelValue":r[1]||(r[1]=n=>b.value=n),indeterminate:T.value,onChange:I},{default:l(()=>[o("全选 ")]),_:1},8,["modelValue","indeterminate"]),t(O,{modelValue:_.value,"onUpdate:modelValue":r[2]||(r[2]=n=>_.value=n),onChange:A},{default:l(()=>[(h(),p($,null,B(v,n=>t(H,{key:n,label:n},{default:l(()=>[o(S(n),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])])):D("",!0),Y.value?(h(),p("div",we,[o(" ** 微信文件夹路径： "),t(V,{placeholder:"密钥key[可为空]",modelValue:g.value,"onUpdate:modelValue":r[3]||(r[3]=n=>g.value=n),style:{width:"50%"}},null,8,["modelValue"])])):D("",!0),j.value?(h(),p("div",fe,[o(" ** 微信文件夹路径： "),t(V,{placeholder:"微信文件夹路径[可为空](eg: C:\\****\\WeChat Files\\wxid_**** )",modelValue:a.value,"onUpdate:modelValue":r[4]||(r[4]=n=>a.value=n),style:{width:"50%"}},null,8,["modelValue"])])):D("",!0)]),t(W,{style:{"margin-top":"10px",width:"50%"},type:"success",onClick:N},{default:l(()=>[o("导出")]),_:1}),t(J),t(V,{type:"textarea",rows:6,readonly:"",placeholder:"",modelValue:e.value,"onUpdate:modelValue":r[5]||(r[5]=n=>e.value=n),style:{width:"100%"}},null,8,["modelValue"])])])])]),_:1})])}}}),ye={id:"chat_view",class:"common-layout"},xe={style:{height:"calc(100vh)",width:"100%","background-color":"#d2d2fa"}},De=C({__name:"ExportView",setup(w){const x=u({account:"",describe:"",headImgUrl:"",nickname:"",remark:"",username:"",chat_count:0}),m=f=>{x.value=f};return(f,_)=>{const g=c("el-aside"),a=c("el-container");return h(),p("div",ye,[t(a,null,{default:l(()=>[t(g,{width:"266px",style:{"overflow-y":"auto",height:"calc(100vh)"}},{default:l(()=>[t(te,{onUserData:m})]),_:1}),d("div",xe,[t(ve,{userData:x.value},null,8,["userData"])])]),_:1})])}}});export{De as default};
