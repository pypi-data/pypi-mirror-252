import{_ as e,D as t,a}from"./SLStatusLabel-ETrzoHxH.js";import{_ as s,u as l,i as r,c,o as n,a as o,b as i,n as d,d as u,t as p,e as m,f as h,r as f,h as v,m as x,g as b,w as y,j as w,R as g,p as k,k as _,l as j,q as $,s as S,S as T,v as L,x as C,y as E,z as A,A as B,B as I,C as U,D as q,E as D}from"./index-khtEKB45.js";import{S as H}from"./SLTable-dc5-bDqm.js";import"./SLLoading-vdw4_byl.js";const R={class:"w-full h-full pt-5 flex flex-col"},O={class:"px-6 border-b flex-shrink-0"},P={class:"flex items-center gap-3"},z={class:"text-xl items-center gap-1 font-semibold max-w-md truncate"},M={key:0,class:"project-description"},N=s({__name:"HomeLayout",setup(a){const s=l(),b=r("isSideBarShow"),y=async(e,t)=>{const{data:a}=await v.patch("/project/update",e);s.updateInfo(a.updates),t()},w=c((()=>{for(const e of s.experiments)if(0===e.status)return!0;return!1})),g=()=>{v.delete("/project").then((()=>{x.success("Delete Successfully"),location.reload()})).catch((()=>{x.error("Error deleting project")}))};return(a,l)=>{const r=e,c=t;return n(),o("div",R,[i("div",O,[i("div",{class:d(["project-title transition-marging duration-300",{"ml-8":!u(b)}])},[i("div",P,[i("h1",z,p(u(s).name),1),m(r,{type:"project",onModify:y})]),i("div",{class:d(["flex justify-end grow transition-padding duration-300 ml-1",{"pr-8":!u(b)}])},[m(c,{type:"project",onConfirm:g,disabled:w.value},null,8,["disabled"])],2)],2),u(s).description?(n(),o("p",M,p(u(s).description),1)):h("",!0),f(a.$slots,"top",{},void 0,!0)]),f(a.$slots,"default",{},void 0,!0)])}}},[["__scopeId","data-v-5fab0587"]]),V=["title"],F={__name:"ExperimentName",props:{name:{type:String,required:!0},color:{type:String,required:!0},id:{required:!0}},setup:e=>(t,a)=>(n(),b(u(g),{class:"flex gap-2 items-center w-full",to:`/experiment/${e.id}`},{default:y((()=>[i("circle",{class:"w-3 h-3 rounded-full flex-shrink-0",style:w({backgroundColor:t.$props.color})},null,4),i("p",{class:"truncate",title:e.name},p(e.name),9,V)])),_:1},8,["to"]))},G={class:"flex-col justify-center items-center pt-10"},J=(e=>(k("data-v-bcdae545"),e=e(),_(),e))((()=>i("div",{class:"loader"},null,-1))),K={class:"text-center pt-10 text-lg"},Q=s({__name:"EmptyTable",setup:e=>(e,t)=>(n(),o("div",G,[J,i("p",K,p(e.$t("home.empty.table")),1)]))},[["__scopeId","data-v-bcdae545"]]),W=["checked"],X={class:"select-none truncate"},Y={__name:"SLCheck",props:{label:{type:String,default:""},checked:{type:Boolean,default:!1}},emits:["update:checked"],setup:e=>(t,a)=>(n(),o("div",{class:"flex items-center gap-2 cursor-pointer",onClick:a[0]||(a[0]=a=>t.$emit("update:checked",!e.checked))},[i("input",{type:"checkbox",class:"border cursor-pointer w-4 h-4",checked:e.checked},null,8,W),i("span",X,p(e.label),1)]))},Z={class:"w-full flex justify-between items-center"},ee={class:"flex gap-5 items-center pl-10"},te={__name:"TableBar",props:{tableBody:{type:Array,default:()=>[]},tableHead:{type:Array,default:()=>[]},checked:{type:Boolean,default:!1},searchText:{type:String,default:""}},emits:["update:checked","update:searchText"],setup(e){const t=(e,t,a)=>{switch(t){case"config":return e.config[a]?e.config[a].value:"-";case"create_time":return S(e.create_time);case"status":return $(`experiment.status.${e.status}`)}};return(a,s)=>{const l=T,r=L,c=C;return n(),o("div",Z,[m(l,{class:"max-w-[400px]",onInput:s[0]||(s[0]=e=>a.$emit("update:searchText",e)),placeholder:a.$t("experiment.index.header.table-bar.placeholder")},null,8,["placeholder"]),i("div",ee,[m(Y,{label:a.$t("experiment.index.header.table-bar.summary"),checked:e.checked,"onUpdate:checked":s[1]||(s[1]=e=>a.$emit("update:checked",e))},null,8,["label","checked"]),m(c,{theme:"default",class:"px-3 py-2 rounded-lg flex items-center gap-2",onClick:s[2]||(s[2]=a=>function(e,a){if(!(e&&a&&Array.isArray(e)&&Array.isArray(a)&&e.length&&a.length))return;let{year:s,month:l,day:r,hour:c,minute:n,second:o}=j((new Date).getTime()-288e5);const i=`swanlab_experiments_${s}-${l}-${r}_${c}-${n}-${o}.csv`;var d="data:text/csv;charset=utf-8,\ufeff";const u=e.map((e=>e.title)).join(",");d+=u+"\n",a.forEach(((s,l)=>{let r="";for(let a=0;a<e.length;a++){const l=e[a],c=l.key||l.slot;r+=(l.type?t(s,l.type,c):s[c]||"-")+","}d+=l<a.length?r.replace(/,$/,"\n"):r.replace(/,$/,"")}));const p=document.createElement("a");p.href=encodeURI(d),p.download=i,p.click(),window.URL.revokeObjectURL(d)}(e.tableHead,e.tableBody)),hollow:""},{default:y((()=>[m(r,{icon:"download",class:"w-4 h-4"}),i("span",null,p(a.$t("experiment.index.header.table-bar.export")),1)])),_:1})])])}}},ae={class:"w-80 flex flex-col gap-4 my-5 text-dimmer"},se={class:"flex justify-between"},le={class:"grow"},re={class:"w-36 whitespace-nowrap"},ce={class:"flex justify-between"},ne={class:"grow"},oe={class:"w-36 whitespace-nowrap"},ie={class:"flex justify-between"},de={class:"grow"},ue={class:"w-36 whitespace-nowrap"},pe={class:"pt-5 flex flex-col flex-grow flex-shrink-0"},me={class:"flex mx-6 mb-4 items-center gap-1.5 flex-shrink-0"},he={class:"text-xl font-semibold"},fe={key:0,class:"bg-positive-dimmest text-positive-higher rounded-full px-3"},ve={key:0,class:"w-full pb-10 flex flex-col overflow-scroll flex-grow basis-0"},xe=s({__name:"HomeView",setup(e){const t=l(),s=c((()=>void 0===t.experiments?[]:t.experiments)),r=c((()=>S(t.createTime))),d=c((()=>S(t.updateTime))),f=c((()=>{var e;return(null==(e=t.experiments)?void 0:e.length)||0})),x=E([{title:$("home.list.table.header.name"),slot:"name",style:"px-6",width:300,border:!0},{title:$("home.list.table.header.status"),slot:"status",type:"status"},{title:$("home.list.table.header.create"),slot:"create",type:"create_time"}]),w=E([]);s.value.map((e=>{Object.entries(e.config).forEach((([e])=>{w.value.some((t=>t.title===e))||w.value.push({type:"config",slot:e,title:e})}))}));const g=c((()=>s.value.map((e=>{const t=_.value[e.name];return t?(Promise.all(Object.keys(t).map((async a=>{e[await j(a)]=D(t[a])}))),e):{}})))),k=E(),_=E({});async function j(e){return"swanlab-overview-table-key"+e}v.get("/project/summaries",{params:{experiment_names:(()=>{let e=[];return s.value.forEach((t=>{e.push(t.name)})),e.join(",")})()}}).then((async({data:e})=>{k.value=await Promise.all(e.tags.map((async e=>({key:await j(e),title:e})))),_.value=e.summaries}));const T=E(!1),L=c((()=>T.value?[x.value[0],...k.value]:[...x.value,...w.value,...k.value||[]])),C=E(""),R=c((()=>C.value?g.value.filter((e=>e.name.toLowerCase().includes(C.value.toLowerCase()))):g.value));return(e,l)=>{const c=N;return n(),b(c,null,{top:y((()=>[i("div",ae,[i("div",se,[i("div",le,p(e.$t("home.overview.create")),1),i("p",re,p(r.value),1)]),i("div",ce,[i("div",ne,p(e.$t("home.overview.latest")),1),i("p",oe,p(d.value),1)]),i("div",ie,[i("div",de,p(e.$t("home.overview.logdir")),1),i("p",ue,p(u(t).logdir),1)])])])),default:y((()=>[i("div",pe,[i("div",me,[i("h2",he,p(e.$t("home.list.title")),1),f.value?(n(),o("span",fe,p(f.value),1)):h("",!0)]),m(te,{class:"pb-4 pt-1 px-5 flex-shrink-0","table-head":L.value,"table-body":R.value,searchText:C.value,checked:T.value,"onUpdate:checked":l[0]||(l[0]=e=>T.value=e),"onUpdate:searchText":l[1]||(l[1]=e=>C.value=e)},null,8,["table-head","table-body","searchText","checked"]),k.value?(n(),o("div",ve,[m(u(H),{"sticky-header":"",class:"dashboard-table",column:L.value,data:R.value,"last-row-gradient":""},A({name:y((({row:e})=>{return[m(F,{name:e.name,id:e.id,color:(t=e,t.light)},null,8,["name","id","color"])];var t})),status:y((({row:e})=>[m(a,{id:e.experiment_id,status:e.status},null,8,["id","status"])])),create:y((({row:e})=>[I(p(u(U)(u(q)(e.create_time))),1)])),_:2},[B(w.value,(e=>({name:e.slot,fn:y((({row:t})=>{var a;return[I(p((null==(a=t.config[e.slot])?void 0:a.value)||"-"),1)]}))})))]),1032,["column","data"])])):0===s.value.length?(n(),b(Q,{key:1})):h("",!0)])])),_:1})}}},[["__scopeId","data-v-1bd72c6d"]]);export{xe as default};
